/*!
 * JSVEE - JavaScript Visual Execution Environment Library
 * (c) Teemu Sirki√§ and Aalto University, 2016 
 * Licensed under MIT license 
 * 
 * Compiled at: 2016-05-09 14:32
 */
'use strict';(function(b){var a=function(f,e){var d={};this.settings=b.extend(true,d,e);this.area=b(f);this.stateNumber=0;this.animationLength=300;this.steps=[];this.state={};this.state.continueRunning=false;this.state.animationsDisabled=false;this.state.explanationsDisabled=false;this.state.stepsToRun=0;this.state.stepNumber=0;
this.state.stepNumberAll=0;this.undoableElements=[];this.undoStack=[];this.redoStack=[];var c=b("<div></div>").addClass("jsvee-core");c.appendTo(this.area);c.attr("data-pc","0");this.addUndoableElement(".jsvee-core");this.actionsRunning=false;this.animationDisabled=false;this.initialized=false;this.disableStateSave=false};a.utils={};a.handlers={functions:{},operators:{},classes:{},actions:{},animations:{},explanations:{},global:null,truthness:null};a.beforeEachInstructionCBs=[];a.beforeEachStepCBs=[];
a.afterEachInstructionCBs=[];a.afterEachStepAfterCBs=[];a.afterEachStepBeforeCBs=[];a.afterInitializationCBs=[];a.registerAction=function(c,d){this.prototype[c]=function(){var g=this;var f=[].slice.call(arguments);if(typeof f[0]!=="function"){f.unshift(function(){return})}if(!this.initialized||this.state.animationsDisabled||this.animationDisabled){d.apply(g,f)}else{var j=function(){try{d.apply(g,f)}catch(k){console.log(k);a.utils.ui.appendToStatus(g.area,a.messages.failedText());g.state.stepsToRun=0;
g.state.runToLine=0;g.animationDisabled=false;g.setPC(999999);g.actionsRunning=false;g.disableStateSave=false;b.each(a.afterEachStepBeforeCBs,function(){this.call(g,null)});b.each(a.afterEachStepAfterCBs,function(){this.call(g,null)})}};var h=[].slice.call(f);h[0]=j;if(a.handlers.explanations.hasOwnProperty(c)&&!this.explanationsDisabled&&this.state.stepsToRun==0){var i=a.handlers.explanations[c].apply(this,h.slice(1));a.utils.ui.setStatusText(this.area,i);var e=f[0];f[0]=function(){var k=[].slice.call(arguments);
a.utils.ui.appendToStatus(g.area,a.messages.readyText());e.call(this,k)}}else{if(this.state.stepsToRun==0){a.utils.ui.setStatusText(this.area," ")}}if(a.handlers.animations.hasOwnProperty(c)){a.handlers.animations[c].apply(g,h)}else{j()}}}};a.prototype.makeStep=function(){if(this.actionsRunning||this.hasEnded()){return}var k=this;var g=0;var l=null;this.state.stepNumber++;if(this.initialized){this.state.stepNumberAll++}var d=function(f,n){return function(){if(k.initialized){b.each(a.afterEachInstructionCBs,function(){this.call(k,f)
})}n()}};var m=function(q,f,r){var o=k.getInstructionName(f);var n=f.slice(1);var p=k.animationDisabled;if(k.initialized){b.each(a.beforeEachInstructionCBs,function(){this.call(k,f)})}k.animationDisabled=r||false;n.unshift(q);k[o].apply(k,n);k.animationDisabled=p};var c=function j(){var n=k.peekNextInstruction();var f=k.steps[n];if(!k.hasEnded()&&f&&f[0][f[0].length-1]==="_"){k.setPC(n+1);l=f;m(d(f,j),f,true)}else{var o=+k.area.find(".jsvee-code-area").attr("data-line");if(k.state.stepsToRun==1||k.state.runToLine&&o===k.state.runToLine){k.state.stepsToRun=0;
if(!k.state.runToLine||k.state.animationsDisabled){a.utils.ui.appendToStatus(k.area,a.messages.readyText())}if(k.state.reEnableAnimations){k.state.animationsDisabled=false}}if((k.state.continueRunning||k.state.stepsToRun>1||(k.state.runToLine&&o!==k.state.runToLine))&&!k.hasEnded()){k.state.stepsToRun=Math.max(0,k.state.stepsToRun-1);if(k.initialized){b.each(a.afterEachStepBeforeCBs,function(){this.call(k,f)});b.each(a.afterEachStepAfterCBs,function(){this.call(k,f)})}if(k.state.runToLine&&o!==k.state.runToLine){k.state.stepNumberAll++
}g++;if(g<300&&k.state.animationsDisabled){h()}else{g=0;window.setTimeout(h,0)}}else{if(k.state.runToLine&&o===k.state.runToLine){k.state.runToLine=0}k.actionsRunning=false;if(k.initialized){b.each(a.afterEachStepBeforeCBs,function(){this.call(k,f)})}if(!k.disableStateSave&&k.initialized){k.saveState()}k.disableStateSave=false;if(k.initialized){b.each(a.afterEachStepAfterCBs,function(){this.call(k,f)})}}}};var i=function(){var n=k.peekNextInstruction();var f=k.steps[n];var o=k.hasEnded();k.setPC(n+1);
if(!o&&f){l=f;m(d(f,c),f,false)}else{c()}};var h=function j(){var n=k.peekNextInstruction();var f=k.steps[n];if(!k.hasEnded()&&f&&f[0][0]==="_"){k.setPC(n+1);l=f;m(d(f,j),f,true)}else{i()}};this.actionsRunning=true;if(k.initialized){b.each(a.beforeEachStepCBs,function(){this.call(k)})}try{h()}catch(e){console.log(e);a.utils.ui.appendToStatus(k.area,a.messages.failedText());k.state.stepsToRun=0;k.state.runToLine=0;k.animationDisabled=false;k.setPC(999999);k.actionsRunning=false;k.disableStateSave=false;
if(k.initialized){b.each(a.afterEachStepBeforeCBs,function(){this.call(k,l)});b.each(a.afterEachStepAfterCBs,function(){this.call(k,l)})}}};a.prototype.saveState=function(){if(this.undoableElements.length>0){var d=b.extend(true,{},this.state);d.dom={};var c=this;b.each(this.undoableElements,function(e,f){var g=c.area.find(f).clone();d.dom[f]=b.extend(true,{},g)});if(this.redoStack.length===0&&this.undoStack.length===0){this.undoStack.push(b.extend(true,{number:++this.stateNumber},this.state))}else{if(this.redoStack.length>0){this.undoStack.push(this.redoStack.pop())
}}d.number=++this.stateNumber;this.undoStack.push(d);this.redoStack.splice(0)}};a.prototype.deleteState=function(){this.undoStack.pop()};a.prototype.canUndo=function(){return this.undoStack.length>1||(this.undoStack.length==1&&this.redoStack.length>0)};a.prototype.canRedo=function(){return this.redoStack.length>0};a.prototype.undo=function(){if(this.undoStack.length>0&&!this.actionsRunning){var d=false;var e=this.undoStack.pop();if(e.number===this.stateNumber){d=true}this.state=b.extend(true,{},e);
this.stateNumber=e.number;this.redoStack.push(e);var c=this;if(d){this.undo()}else{b.each(this.undoableElements,function(f,g){b(c.area.find(g)).replaceWith(e.dom[g].clone())})}}};a.prototype.redo=function(){if(this.redoStack.length>0&&!this.actionsRunning){var d=false;var e=this.redoStack.pop();if(e.number===this.stateNumber){d=true}this.state=b.extend(true,{},e);this.stateNumber=e.number;this.undoStack.push(e);var c=this;if(d){this.redo()}else{b.each(this.undoableElements,function(f,g){b(c.area.find(g)).replaceWith(e.dom[g].clone())
})}}};a.prototype.toBegin=function(){while(!this.actionsRunning&&this.undoStack.length>0){this.undo()}};a.prototype.getPC=function(){return +this.area.find(".jsvee-core").attr("data-pc")};a.prototype.setPC=function(c){if(c.toString()[0]==="@"){this.area.find(".jsvee-core").attr("data-pc",this.findLabel(c)+1)}else{this.area.find(".jsvee-core").attr("data-pc",c)}};a.prototype.hasEnded=function(){return this.getPC()>=this.steps.length||this.getInstructionName(this.steps[this.getPC()])==="end"};a.prototype.findLabel=function(c){var e=c;
if(c[0]==="@"){e=c.substring(1)}var d=0;for(d=0;d<this.steps.length;d++){if(this.getInstructionName(this.steps[d])==="label"&&this.steps[d][1]===e){return d}}return this.steps.length+1};a.prototype.initReady=function(){var c=this;this.initialized=true;var d={};b.each(this.undoableElements,function(e,f){var g=c.area.find(f).clone();d[f]=b.extend(true,{},g)});this.state.dom=d;this.undoStack.push(b.extend(true,{number:++this.stateNumber},this.state));b.each(a.afterInitializationCBs,function(){this.call(c)
})};a.prototype.addUndoableElement=function(c){var d=this;if(typeof c==="string"){this.undoableElements.push(c)}else{if(b.isArray(c)){b.each(function(e,f){d.undoableElements.push(f)})}}};a.prototype.addStep=function(c){this.steps.push(c)};a.prototype.peekNextInstruction=function(d){var e=d||this.getPC();var c=null;while(e<this.steps.length){c=this.steps[e];if(this.getInstructionName(c)==="label"){e++}else{if(this.getInstructionName(c)==="goto"){if(c[1].toString()[0]==="@"){e=this.findLabel(c[1])}else{e=+c[1]
}}else{break}}}return e};a.prototype.getInstructionName=function(c){if(c[0][0]==="_"){return c[0].substring(1)}if(c[0][c[0].length-1]==="_"){return c[0].substring(0,c[0].length-1)}return c[0]};a.beforeEachInstruction=function(c){a.beforeEachInstructionCBs.push(c)};a.beforeEachStep=function(c){a.beforeEachStepCBs.push(c)};a.afterEachInstruction=function(c){a.afterEachInstructionCBs.push(c)};a.afterEachStep=function(d,c){if(d){a.afterEachStepAfterCBs.push(c)}else{a.afterEachStepBeforeCBs.push(c)}};
a.afterInitialization=function(c){a.afterInitializationCBs.push(c)};window.JSVEE=a}(jQuery));(function(a){if(window.JSVEE==="undefined"){return}JSVEE.messages={};if(!String.prototype.format){String.prototype.format=function(){var b=arguments;return this.replace(/\{(\d+)\}/g,function(c,d){return(b[d]!==undefined)?b[d]:c})}}JSVEE.messages.beginButton=function(){return"Move to begin"};JSVEE.messages.prevButton=function(){return"Undo"};JSVEE.messages.stepButton=function(){return"Step forward"};JSVEE.messages.redoButton=function(){return"Redo"
};JSVEE.messages.consoleTitle=function(){return"Text console"};JSVEE.messages.stackTitle=function(){return"Stack, all the stack frames are stored here."};JSVEE.messages.literals=function(){return"Literals"};JSVEE.messages.stack=function(){return"Stack"};JSVEE.messages.literalsTitle=function(){return"Values needed during the execution are stored here."};JSVEE.messages.stackFrameTitle=function(){return"Stack frame, memory area containing the data related to the currently running code."};JSVEE.messages.evaluationAreaTitle=function(){return"Evaluation area, expressions will be evaluated here"
};JSVEE.messages.stackFrame=function(){return"Stack frame"};JSVEE.messages.evaluationArea=function(){return"Evaluation area"};JSVEE.messages.valueTitle=function(b){return"Value {0}".format(b)};JSVEE.messages.valueTitleWithType=function(b,c){return"Value {0} of type {1}".format(c,b)};JSVEE.messages.operatorTitle=function(b){return"Operator {0}".format(b)};JSVEE.messages.functionTitle=function(b){return"Function {0}".format(b)};JSVEE.messages.methodTitle=function(b){return"Method {0}".format(b)};JSVEE.messages.classTitle=function(b){return"Class {0}".format(b)
};JSVEE.messages.readyText=function(){return" - ready."};JSVEE.messages.failedText=function(){return" - failed!"};JSVEE.messages.variable=function(b){return"Variable {0}".format(b)};JSVEE.messages.instanceTitle=function(b,c){return"{0} object, in memory at location {1}".format(b,c)};JSVEE.messages.referenceTitle=function(b){return"A reference to an object, which is in the memory at location {0}".format(b)};JSVEE.messages.undo=function(){return"Moved one step backwards."};JSVEE.messages.begin=function(){return"Rewound back to the start."
};JSVEE.messages.redo=function(){return"Moved one step forward."};JSVEE.messages.animationEnded=function(){return"End of the animation."};JSVEE.messages.setLine=function(b){return"Moving to the line {0}".format(b)};JSVEE.messages.jumpFalse=function(b){return"Condition is false, moving to the line {0}".format(b)};JSVEE.messages.jumpTrue=function(b){return"Condition is true, moving to the line {0}".format(b)};JSVEE.messages.jumpIterationReady=function(b){return"Finished the iteration, moving to the line {0}".format(b)
};JSVEE.messages.createVariable=function(b){return"Creating a new variable {0}".format(b)};JSVEE.messages.addValue=function(d,b,c){return"Fetching value {0}".format(d)};JSVEE.messages.assign=function(b){return"Assigning value to the variable {0}".format(b)};JSVEE.messages.assignField=function(b){return"Assigning value to the instance variable {0}".format(b)};JSVEE.messages.addValueFromVariable=function(b){return"Fetching value from the variable {0}".format(b)};JSVEE.messages.addValueFromField=function(b){return"Fetching value from the instance variable {0}".format(b)
};JSVEE.messages.addOperator=function(b){if(b=="int"){return"Fetching the type cast operator {0}".format(b)}else{return"Fetching the operator {0}".format(b)}};JSVEE.messages.evaluateOperator=function(b){if(b=="int"){return"Evaluating the type cast operator {0}".format(b)}else{return"Evaluating the operator {0}".format(b)}};JSVEE.messages.addFunction=function(b){return"Fetching the function {0}".format(b)};JSVEE.messages.addMethod=function(b){return"Fetching the method {0}".format(b)};JSVEE.messages.createParameterVariables=function(){return"Creating the parameter variables"
};JSVEE.messages.assignParameter=function(b){return"Assigning value to the parameter variable ".format(b)};JSVEE.messages.assignParameters=function(){return"Assigning parameter values to the parameter variables"};JSVEE.messages.evaluateBuiltInFunction=function(b){return"Evaluating the built-in function {0}".format(b)};JSVEE.messages.evaluateFunction=function(b){return"Starting evaluation of the function {0}".format(b)};JSVEE.messages.evaluateBuiltInMethod=function(b){return"Evaluating the built-in method {0}".format(b)
};JSVEE.messages.evaluateMethod=function(b){return"Starting evaluation of the method {0}".format(b)};JSVEE.messages.returnValue=function(){return"Returning the return value"};JSVEE.messages.returnVoid=function(){return"Ending the call"};JSVEE.messages.addReference=function(b){return"Fetching a reference to an object, which is in the memory at location {0}".format(b)};JSVEE.messages.createInstance=function(b){if(b==="dict"){return"Creating a new dictionary"}else{if(b==="list"){return"Creating a new list"
}}return"Creating a new {0} object".format(b)};JSVEE.messages.createField=function(b){return"Creating a new instance variable {0}".format(b)};JSVEE.messages.createArray=function(b){return"Creating a new {0} array".format(b)};JSVEE.messages.getValueAtIndex=function(){return"Fetching value from the list"};JSVEE.messages.getValueByKey=function(){return"Fetching value by the key"};JSVEE.messages.setValueAtIndex=function(){return"Assigning value to the list"};JSVEE.messages.setValueByKey=function(){return"Assigning value to the dictionary"
};JSVEE.messages.addCollectionInitializer=function(){return"Starting the initialization of the collection"};JSVEE.messages.initializeCollection=function(){return"Initializing the collection"};JSVEE.messages.takeNext=function(){return"Fetching the next value of the collection"};JSVEE.messages.createFunction=function(b){return"Defining function {0}".format(b)}}(jQuery));(function(a){if(window.JSVEE===undefined){return}JSVEE.utils.ui={};JSVEE.utils.ui.createFrame=function(c,d){var g=a("<div></div>").addClass("jsvee-stack-frame");
var b=a("<div></div>").text(JSVEE.messages.stackFrame());var f=JSVEE.utils.ui.createEmptyVar();var e=JSVEE.utils.ui.createEvaluationArea();g.attr("title",JSVEE.messages.stackFrameTitle());g.attr("data-pc",c);if(d){g.addClass("jsvee-small")}else{b.addClass("jsvee-area-label jsvee-area-label2");b.appendTo(g)}f.appendTo(g);e.appendTo(g);return g};JSVEE.utils.ui.createEmptyVar=function(){var b=a("<div></div>");b.addClass("jsvee-variable-empty");return b};JSVEE.utils.ui.createEvaluationArea=function(){var b=a("<div></div>").addClass("jsvee-evaluation-area");
b.attr("title",JSVEE.messages.evaluationAreaTitle());b.attr("data-title",JSVEE.messages.evaluationArea());return b};JSVEE.utils.ui.resizeStack=function(b){var g=b.find(".jsvee-stack");var f=0;var d=g.find(".jsvee-stack-filler");var h=b.find(".jsvee-code-area"),j=0;var i=b.find(".jsvee-right-panels");g.find(".jsvee-stack-frame").each(function(){f+=a(this).outerHeight(true)});d.css("height","0px");j=g.height();if(j-f>0){d.css("height",(j-f)+"px")}if(i.outerHeight(true)>j){var e=parseInt(d.css("height"),10);
d.css("height",(e+(i.outerHeight(true)-g.outerHeight(true)))+"px")}if(h.hasClass("jsvee-code-left")&&h.outerHeight(true)>b.find(".jsvee-memory-area").outerHeight(true)){var c=h.outerHeight(true)-b.find(".jsvee-memory-area").outerHeight(true);var e=parseInt(d.css("height"),10);d.css("height",(e+c)+"px")}g.attr("data-height",f)};JSVEE.utils.ui.createValue=function(c,e,b){var d=a("<div></div>").addClass("jsvee-value");d.attr("data-type",b).attr("data-value",c);d.attr("data-id",e);if(b){d.attr("title",JSVEE.messages.valueTitleWithType(b,c))
}else{d.attr("title",JSVEE.messages.valueTitle(c))}d.text(c);return d};JSVEE.utils.ui.findValue=function(d,e,c){var b=d.find(".jsvee-heap");if(c){return b.children('.jsvee-value[data-value="'+e+'"][data-type="'+c+'"]').first()}return b.children('.jsvee-value[data-value="'+e+'"]').first()};JSVEE.utils.ui.findValueById=function(c,e){if(+e>=0){var b=c.find('.jsvee-instance[data-id="'+e+'"]');if(b.length>0){return b.first()}return c.find('.jsvee-heap .jsvee-value[data-id="'+e+'"]').first()}var d=+c.find(".jsvee-heap").attr("data-id-counter");
return c.find('.jsvee-instance[data-id="'+(d-1)+'"]').first()};JSVEE.utils.ui.findOrCreateValue=function(f,g,e){var b=JSVEE.utils.ui.findValue(f,g,e);if(b.length===0){var i=+f.find(".jsvee-heap").attr("data-id-counter");f.find(".jsvee-heap").attr("data-id-counter",i+1);var d=g;if(e==="Double"&&g.toString().split(".").length>1&&g.toString().split(".")[1].length>3){d=g.toFixed(3)}var h=JSVEE.utils.ui.createValue(d,i,e);var c=f.find(".jsvee-heap");h.appendTo(c);return h}return b.first()};JSVEE.utils.ui.createInstance=function(e,d){var g=+e.find(".jsvee-heap").attr("data-id-counter");
e.find(".jsvee-heap").attr("data-id-counter",g+1);var b=a("<div></div>").addClass("jsvee-instance");var c=a("<div></div>").addClass("jsvee-name");var f=a("<div></div>").addClass("jsvee-name2");b.attr("data-type",d);b.attr("data-id",g);b.attr("title",JSVEE.messages.instanceTitle(d,g));c.text(g);c.appendTo(b);f.text(d);f.appendTo(c);return b};JSVEE.utils.ui.createReference=function(d,e){var c=a("<div></div>").addClass("jsvee-value jsvee-ref");var b=d.find('.jsvee-instance[data-id="'+e+'"]').first().attr("data-type");
c.attr("data-id",e);c.attr("data-type",b);c.text(e);c.attr("title",JSVEE.messages.referenceTitle(e));return c};JSVEE.utils.ui.findLastInstance=function(b){return b.find(".jsvee-heap .jsvee-instance").last()};JSVEE.utils.ui.findReference=function(c,d){var b=null;if(d===undefined||+d<0){b=JSVEE.utils.ui.findLastInstance(c)}else{b=JSVEE.utils.ui.findValueById(c,d)}return JSVEE.utils.ui.createReference(c,b.attr("data-id"))};JSVEE.utils.ui.createOperator=function(b,d,c,e){var f=a("<div></div>").addClass("jsvee-operator");
f.attr("title",JSVEE.messages.operatorTitle(b));f.attr("data-name",b);f.attr("data-class",(c&&c.trim().length>0)?c:null);f.attr("data-type",d);f.attr("data-params",e);f.text(b);return f};JSVEE.utils.ui.createFunction=function(d,i,h,c,e,b){var g=a("<div></div>").addClass("jsvee-function");g.attr("data-name",d);g.attr("data-params",h);g.attr("data-pc",c);g.attr("data-class",e);g.attr("data-static",b);g.text(i);if(e){g.attr("title",JSVEE.messages.methodTitle(d))}else{g.attr("title",JSVEE.messages.functionTitle(d))
}if(+c<=0){g.addClass("jsvee-function-builtin")}return g};JSVEE.utils.ui.createClass=function(b){var e=a("<div></div>").addClass("jsvee-class").attr("data-name",b);e.attr("title",JSVEE.messages.classTitle(b));var d=a("<div></div>").addClass("jsvee-name");d.text(b);d.appendTo(e);return e};JSVEE.utils.ui.fadeInAndRemove=function(c,e,b){var d=this,f=[];f.push(function(g){if(!a.isArray(g)){g.hide().fadeIn(d.animationLength,function(){g.remove();c()})}else{a.each(g,function(h){var j=this;this.hide().fadeIn(j.animationLength,function(){j.remove();
if(h===g.length-1){c()}})})}});f.push.apply(f,b);e.apply(this,f)};JSVEE.utils.ui.highlightCurrentLine=function(b,j,d){var i=b.find(".jsvee-code-table");i.find(".jsvee-arrow-right").remove();i.find(".jsvee-gutter.jsvee-current").removeClass("jsvee-current");var g=a("<div></div>").addClass("jsvee-arrow-right");i.find(".jsvee-gutter").eq(j-1).addClass("jsvee-current").prepend(g);var h=b.find(".jsvee-current-code-line").parent();if(h.children().length>1){h.find("span").remove();a("<span></span>").text(h.attr("data-text")).appendTo(h)
}i.find(".jsvee-current-code-line").removeClass("jsvee-current-code-line");var e=i.find(".jsvee-code-line").eq(j-1);e.children().remove();if(d){var c=d.split(":");c[1]=parseInt(c[1],10);a("<span></span>").text(e.attr("data-text").substring(0,c[0])).appendTo(e);var f=a("<span></span>").text(e.attr("data-text").substring(c[0],c[1]+1));f.addClass("jsvee-current-code-line").appendTo(e);a("<span></span>").text(e.attr("data-text").substring(c[1]+1)).appendTo(e)}else{a("<span></span>").text(e.attr("data-text")).addClass("jsvee-current-code-line").appendTo(e)
}};JSVEE.utils.ui.showInfoText=function(b,c,d){if(!d){b.find(".jsvee-info-area").text(c).show()}else{b.find(".jsvee-info-area").html(c).show()}};JSVEE.utils.ui.hideInfo=function(b){b.find(".jsvee-info-area").hide().text("").children().remove()};JSVEE.utils.ui.setStatusText=function(b,c){b.find(".jsvee-status-area").text(c)};JSVEE.utils.ui.appendToStatus=function(c,d){var b=c.find(".jsvee-status-area");b.text(b.text()+d)};JSVEE.utils.ui.createVariable=function(c){var d=c.split(".");var e=d[d.length-1];
var b=a("<div></div>").addClass("jsvee-variable");b.attr("data-name",e);b.attr("title",JSVEE.messages.variable(e));a("<div></div>").text(e).addClass("jsvee-name").appendTo(b);return b};JSVEE.utils.ui.createEmptyVariable=function(){return a("<div></div>").addClass("jsvee-variable-empty-hover")};JSVEE.utils.ui.placeVariable=function(d,b,f,e){var g=b.split(".");if(g.length===1&&!e){d.find(".jsvee-stack-frame").first().find(".jsvee-variable-empty").before(f)}else{if(e){var h=JSVEE.utils.ui.findVariable(d,e.substring(1));
var c=h.find(".jsvee-value").attr("data-id");var j=JSVEE.utils.ui.findValueById(d,c);j.append(f)}else{var k=d.find('.jsvee-class[data-name="'+g[0]+'"]').last();if(k.find(".jsvee-variable-empty").length>0){k.find(".jsvee-variable-empty").before(f)}else{if(k.find(".jsvee-function").length>0){k.find(".jsvee-function").first().before(f)}else{k.append(f)}}if(k.find(".jsvee-variable-empty").length===0){var i=a("<div></div>").addClass("jsvee-variable-empty");k.find(".jsvee-variable, .jsvee-variable-empty-hover").last().after(i)
}}}};JSVEE.utils.ui.findEvaluationArea=function(d,b){var f=d.find(".jsvee-evaluation-area").first();var c=0;if(b){var e=b.split("/");for(c=0;c<e.length-1;c++){if(c%2===0){f=f.children().eq(e[c])}else{f=f.find(".jsvee-evaluation-area-param").eq(e[c])}}}return f};JSVEE.utils.ui.animateMoveToTarget=function(b,d,e,c,i,h,f){var g=d.clone();g.css("top","");g.css("left","");var j=null;if(f){j=[f.position().left,f.position().top]}else{if(!h){g.appendTo(e)}else{e.before(g)}j=[g.position().left,g.position().top]
}g.remove();JSVEE.utils.ui.animateMove.call(this,b,d,j,c,function(){i()})};JSVEE.utils.ui.animateMove=function(b,d,g,e,h){var j=this.animationLength;var c=d;var f=null;var i=null;if(!e){f=d.clone().css("position","absolute");f.appendTo(b);f.offset(d.offset());if(!d.is(":visible")&&d.is(".jsvee-value")){f.offset(b.find(".jsvee-literals").offset())}f.css("z-index","999");c=f}else{d.css("z-index","999");if(d.css("position")!=="absolute"){d.css("position","absolute");d.offset(d.offset())}if(!d.parent().is(".jsvee-animation-area")){i=a("<div></div>").css("height",d.outerHeight(true)+"px").css("width",d.outerWidth(true)+"px");
d.before(i)}}c.animate({top:g[1]+"px",left:g[0]+"px"},j,function(){if(f!==null){f.remove()}else{d.css("z-index","");d.css("position","");d.css("top","");d.css("left","")}if(i!==null){i.remove()}h()})};JSVEE.utils.ui.findVariable=function(f,e,h){var d=null;var g=e.split(".");if(g.length===1&&!h){d=f.find(".jsvee-stack-frame").first().find('.jsvee-variable[data-name="'+e+'"]')}else{if(h){var c=JSVEE.utils.ui.findValueById(f,h);d=c.find('.jsvee-variable[data-name="'+e+'"]')}else{var b=f.find('.jsvee-class[data-name="'+g[0]+'"]').last();
d=b.find('.jsvee-variable[data-name="'+g[1]+'"]')}}if(d.length===0){return null}return d.last()};JSVEE.utils.ui.findFirstValue=function(b){var c=b.find(".jsvee-stack-frame").first().find(".jsvee-evaluation-area").first();return c.find(".jsvee-value, .jsvee-function").first()};JSVEE.utils.ui.findElement=function(f,b,e){if(!b){return null}var h=f.find(".jsvee-evaluation-area").first();var g=b.split("/");var d=0;var c=null;for(d=0;d<g.length;d++){if(h.length===0){return null}c=g[d];if(d===g.length-1&&e){h=h.children().eq(c-1)
}else{if(h.hasClass("jsvee-function")||h.hasClass("jsvee-operator")){h=h.find(".jsvee-evaluation-area-param").eq(c)}else{h=h.children().eq(c)}}}return h};JSVEE.utils.ui.findOperator=function(f,d,b){var e=null;if(!b){e=f.find(".jsvee-evaluation-area").first().children().last()}else{e=JSVEE.utils.ui.findElement(f,b,true)}var c=e.attr("data-type");var g=f.find('.jsvee-class[data-name="'+c+'"] .jsvee-operator[data-name="'+d+'"]');if(g.length===0){g=f.find('.jsvee-operators .jsvee-operator[data-name="'+d+'"]')
}return g.first()};JSVEE.utils.ui.findOperands=function(e){var d=e.prev();var c=e.next();var b=[];if(e.attr("data-type")==="lr"){b=[d,c]}else{if(e.attr("data-type")==="l"){b=[d]}else{if(e.attr("data-type")==="r"){b=[c]}}}return b};JSVEE.utils.ui.flashElement=function(c,b){var d=this;var e=JSVEE.utils.ui.findElement(this.area,b);e.addClass("jsvee-highlight");e.animate({delay:1},d.animationLength/2,function(){e.removeClass("jsvee-highlight");e.animate({delay:1},d.animationLength/2,function(){c()})})
};JSVEE.utils.ui.findFunction=function(d,b,f,i,h){if(!i){var e=d.find('.jsvee-functions .jsvee-function[data-name="'+b+'"][data-params="'+f+'"]').first();if(e.length==0){e=d.find('.jsvee-functions .jsvee-function[data-name="'+b+'"]').first();if(+e.attr("data-params")<0){return e}}else{return e}return null}var c=i;if(i==="?"){var g=JSVEE.utils.ui.findElement(d,h,true);c=g.attr("data-type")}if(+f>0){var l='.jsvee-classes .jsvee-class[data-name="'+c+'"]';var k=' .jsvee-function[data-name="'+b+'"][data-params="'+f+'"]';
var j=' .jsvee-function[data-name="'+b+'"][data-params="-1"]';return d.find(l+k+", "+l+j).first()}var m='.jsvee-classes .jsvee-class[data-name="'+c+'"] .jsvee-function[data-name="'+b+'"]';return d.find(m).first()};JSVEE.utils.ui.convertFunctionToCallable=function(d){d.attr("title","");if(!d.children().first().hasClass("jsvee-ref")){d.text("");var f=a("<div></div>").addClass("jsvee-function-name");f.css("display","inline-block");f.text(d.attr("data-name"));f.appendTo(d)}var g=+d.attr("data-params");
var c=0;for(c=0;c<g;c++){if(c>0){d.append(a('<div style="display: inline-block; vertical-align: bottom;">&nbsp;,&nbsp;</div>'))}a("<div></div>").addClass("jsvee-evaluation-area-param").appendTo(d)}if(d.attr("data-class")&&!d.attr("data-static")){var e=a("<div></div>");e.addClass("jsvee-evaluation-area-param jsvee-self-param").prependTo(d);var b=d.prev();b.remove();b.appendTo(e);f.text(" . "+f.text())}};JSVEE.utils.ui.createCollectionInitializer=function(c,b,k){var e=a("<div></div>").addClass("jsvee-operator");
var g=a("<div></div>");g.addClass("jsvee-evaluation-area-param jsvee-self-param").appendTo(e);var f=JSVEE.utils.ui.findValueById(c,b);var j=JSVEE.utils.ui.createReference(c,f.attr("data-id"));j.appendTo(g);var h=a("<span></span>").html(" &larr; ");h.appendTo(e);var d=0;for(d=0;d<k;d++){if(d>0){e.append(a('<div style="display: inline-block; vertical-align: bottom;">&nbsp;,&nbsp;</div>'))}a("<div></div>").addClass("jsvee-evaluation-area-param").appendTo(e)}return e};JSVEE.utils.ui.createOperatorParameters=function(b){var d=b.attr("data-params").split("#");
b.text("");if(b.attr("data-type")==="pr"){var c=a("<div></div>");c.addClass("jsvee-evaluation-area-param jsvee-self-param").prependTo(b);b.prev().appendTo(b)}a.each(d,function(e,h){var f=a("<span></span>").text(h);b.append(f);if(e<d.length-1){var g=a("<div></div>").addClass("jsvee-evaluation-area-param");g.appendTo(b)}})};JSVEE.utils.ui.isFunctionBuiltin=function(c){var b=c.attr("data-pc");return !(b.toString()[0]==="@"||+b>=0)};JSVEE.utils.ui.findActiveCall=function(c){var d=c.find(".jsvee-stack-frame").eq(1);
var b=d.find(".jsvee-function.jsvee-active");return b};JSVEE.utils.ui.findParameterValue=function(c,b){var e=JSVEE.utils.ui.findActiveCall(c).find(".jsvee-evaluation-area-param").eq(b);var d=e.find(".jsvee-value, .jsvee-function").first();return d};JSVEE.utils.ui.findValueInCollection=function(e,g,c){var f=JSVEE.utils.ui.findValueById(e,g);var d=f.children(".jsvee-value");var b=+c;if(b<0){b=d.length+b}return d.eq(b)};JSVEE.utils.ui.findValueInSet=function(c,f,b){var e=JSVEE.utils.ui.findValueById(c,f);
var d=e.children('.jsvee-key-value-pair[data-key="'+b+'"]');if(d.length==0){return null}else{return d.find(".jsvee-value").eq(1)}};JSVEE.utils.ui.createKeyValuePair=function(c,g,b,d){var f=JSVEE.utils.ui.findValueById(c,g);var e=a("<div></div>").addClass("jsvee-key-value-pair").attr("data-key",b.text());e.appendTo(f);b.clone().appendTo(e);a("<span></span>").text(":").appendTo(e);d.clone().appendTo(e);return e};JSVEE.utils.ui.createOverlay=function(){var b=a("<div></div>").addClass("jsvee-overlay");
var c=a("<div></div>").addClass("jsvee-overlay-content");b.appendTo(a("body"));c.appendTo(a("body"));b.css("height",a(document).height()+"px");c.css("height",(a(window).height()-100)+"px");return c};JSVEE.utils.ui.removeOverlay=function(){a(".jsvee-overlay, .jsvee-overlay-content").remove()};JSVEE.utils.ui.createIterator=function(b,e,g,f,d){var c=a("<div></div>").addClass("jsvee-iterator").attr("data-name",b);c.attr("data-first","true");if(!g&&!f){c.attr("data-collection",e);c.attr("data-current",-1);
if(d){c.attr("data-type",d)}}else{c.attr("data-to",f);c.attr("data-type",d);c.attr("data-current",+g-1)}return c};JSVEE.utils.ui.findValueToBeIterated=function(d,b){var c=null;var e=b.attr("data-collection");b.attr("data-first","false");if(e){var g=JSVEE.utils.ui.findValueById(d,e);var f=+b.attr("data-current");if(g.hasClass("jsvee-instance")){if(g.children(".jsvee-item").length>0){c=g.children(".jsvee-item").eq(f).find(".jsvee-value").first()}else{if(g.children(".jsvee-key-value-pair").length>0){c=g.children(".jsvee-key-value-pair").eq(f).find(".jsvee-value").first()
}else{c=g.children(".jsvee-value").eq(f)}}}else{c=g.attr("data-value").charAt(f);c=JSVEE.utils.ui.findOrCreateValue(d,c,b.attr("data-type"))}}else{var f=+b.attr("data-current");c=JSVEE.utils.ui.findOrCreateValue(d,f,b.attr("data-type"))}return c};JSVEE.utils.ui.drawArrow=function(d,q,o){var l=function(i){var j=[i.position().left+i.outerWidth()/2,i.position().top];var t=[i.position().left+i.outerWidth()/2,i.position().top+i.outerHeight()];var u=[i.position().left,i.position().top+i.outerHeight()/2];
var v=[i.position().left+i.outerWidth(),i.position().top+i.outerHeight()/2];return[j,t,u,v]};var s=l(q);var r=l(o);if(o.position().top-q.position().top<-50&&a.contains(d.find(".jsvee-heap")[0],o[0])){r=[r[1],r[1],r[1],r[1]];s=[s[0],s[0],s[0],s[0]]}var f=null;var b=-1;for(var k=0;k<4;k++){for(var h=0;h<4;h++){var g=(s[k][0]-r[h][0]);var e=(s[k][1]-r[h][1]);var m=g*g+e*e;if(b<0||m<b){b=m;f=[s[k],r[h]]}}}var c=d.width();var p=d.height();var n='<svg pointer-events="none" class="jsvee-ref-arrow" width="'+c+'" height="'+p+'" version="1.1" xmlns="http://www.w3.org/2000/svg" style="position: absolute; top: 0; left: 0;"><defs><marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerUnits="strokeWidth" markerWidth="4" markerHeight="4" orient="auto"><path stroke="#2756A3" fill="#2756A3" d="M 0 0 L 10 5 L 0 10 z"/></marker></defs><path d="M '+f[0][0]+" "+f[0][1]+" L "+f[1][0]+" "+f[1][1]+'" " fill="none" stroke="#2756A3" stroke-width="1.5" marker-end="url(#arrow)"/></svg>';
return a(n)}}(jQuery));(function(b){if(window.JSVEE===undefined){return}var a=function(c){return function(){var d=[].slice.call(arguments);JSVEE.utils.ui.fadeInAndRemove.call(this,d[0],c,d.slice(1))}};JSVEE.handlers.actions.createFrame=function(f,d,e){var h=null;var g=null;if(d&&d.toString()[0]==="@"){g=this.findLabel(d.substring(1));h=JSVEE.utils.ui.createFrame(g,e)}else{g=d||0;h=JSVEE.utils.ui.createFrame(g,e)}var c=this.getPC();this.area.find(".jsvee-stack-frame").first().attr("data-pc",c);this.area.find(".jsvee-stack .jsvee-stack-filler").after(h);
JSVEE.utils.ui.resizeStack(this.area);f(h)};JSVEE.registerAction("createFrame",JSVEE.handlers.actions.createFrame);JSVEE.handlers.animations.createFrame=a(JSVEE.handlers.actions.createFrame);JSVEE.handlers.actions.createValue=function(d,e,c){var f=JSVEE.utils.ui.findOrCreateValue(this.area,e,c);d(f)};JSVEE.registerAction("createValue",JSVEE.handlers.actions.createValue);JSVEE.handlers.animations.createValue=a(JSVEE.handlers.actions.createValue);JSVEE.handlers.actions.createOperator=function(f,c,e,d,g){var h=JSVEE.utils.ui.createOperator(c,e,d,g);
if(d&&d.trim().length>0){this.area.find('.jsvee-class[data-name="'+d+'"]').append(h)}else{this.area.find(".jsvee-operators").append(h)}f(h)};JSVEE.registerAction("createOperator",JSVEE.handlers.actions.createOperator);JSVEE.handlers.animations.createOperator=a(JSVEE.handlers.actions.createOperator);JSVEE.handlers.actions.createFunction=function(h,e,k,j,d,g,c){var i=JSVEE.utils.ui.createFunction(e,k,j,d,g,c);if(g){this.area.find('.jsvee-class[data-name="'+g+'"]').last().append(i)}else{this.area.find(".jsvee-functions").append(i)
}h(i)};JSVEE.registerAction("createFunction",JSVEE.handlers.actions.createFunction);JSVEE.handlers.animations.createFunction=a(JSVEE.handlers.actions.createFunction);JSVEE.handlers.explanations.createFunction=JSVEE.messages.createFunction;JSVEE.handlers.actions.createClass=function(e,d){var f=JSVEE.utils.ui.createClass(d);this.area.find(".jsvee-classes").append(f);e(f)};JSVEE.registerAction("createClass",JSVEE.handlers.actions.createClass);JSVEE.handlers.animations.createClass=a(JSVEE.handlers.actions.createClass);
JSVEE.handlers.actions.setLine=function(f,d,c){var e=this.area.find(".jsvee-stack-frame").first();e.attr("data-line",d);e.find(".jsvee-evaluation-area").children().remove();JSVEE.utils.ui.highlightCurrentLine(this.area,d,c);this.area.find(".jsvee-code-area").attr("data-line",d);f()};JSVEE.registerAction("setLine",JSVEE.handlers.actions.setLine);JSVEE.handlers.explanations.setLine=JSVEE.messages.setLine;JSVEE.registerAction("jumpTrue",JSVEE.handlers.actions.setLine);JSVEE.handlers.explanations.jumpTrue=JSVEE.messages.jumpTrue;
JSVEE.registerAction("jumpFalse",JSVEE.handlers.actions.setLine);JSVEE.handlers.explanations.jumpFalse=JSVEE.messages.jumpFalse;JSVEE.registerAction("jumpIterationReady",JSVEE.handlers.actions.setLine);JSVEE.handlers.explanations.jumpIterationReady=JSVEE.messages.jumpIterationReady;JSVEE.handlers.actions.setLineHighlight=function(e,d,c){JSVEE.utils.ui.highlightCurrentLine(this.area,d,c);e()};JSVEE.registerAction("setLineHighlight",JSVEE.handlers.actions.setLineHighlight);JSVEE.handlers.actions.createVariable=function(e,d,f){var c=JSVEE.utils.ui.createVariable(d);
JSVEE.utils.ui.placeVariable(this.area,d,c,f);JSVEE.utils.ui.resizeStack(this.area);e(c)};JSVEE.registerAction("createVariable",JSVEE.handlers.actions.createVariable);JSVEE.handlers.animations.createVariable=a(JSVEE.handlers.actions.createVariable);JSVEE.handlers.explanations.createVariable=JSVEE.messages.createVariable;JSVEE.registerAction("createField",JSVEE.handlers.actions.createVariable);JSVEE.handlers.animations.createField=a(JSVEE.handlers.actions.createVariable);JSVEE.handlers.explanations.createField=JSVEE.messages.createField;
JSVEE.handlers.actions.addValue=function(e,f,c,d){var h=JSVEE.utils.ui.findOrCreateValue(this.area,f,d).clone();var g=JSVEE.utils.ui.findEvaluationArea(this.area,c);h.appendTo(g);e(h)};JSVEE.handlers.animations.addValue=function(e,f,c,d){var h=JSVEE.utils.ui.findOrCreateValue(this.area,f,d);var g=JSVEE.utils.ui.findEvaluationArea(this.area,c);JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,h,g,false,e)};JSVEE.registerAction("addValue",JSVEE.handlers.actions.addValue);JSVEE.handlers.explanations.addValue=JSVEE.messages.addValue;
JSVEE.handlers.actions.assign=function(f,e,c){var h=null;var d=null;var i=null;if(c===undefined||c.toString()[0]==="@"){h=JSVEE.utils.ui.findFirstValue(this.area);if(c&&c.toString()[0]==="@"){if(h.length==0){h=JSVEE.utils.ui.findVariable(this.area,e).find(".jsvee-value").clone()}var g=JSVEE.utils.ui.findVariable(this.area,c.substring(1));i=g.find(".jsvee-value").attr("data-id");d=JSVEE.utils.ui.findVariable(this.area,e,i)}else{d=JSVEE.utils.ui.findVariable(this.area,e)}}else{h=JSVEE.utils.ui.findParameterValue(this.area,c).clone();
d=JSVEE.utils.ui.findVariable(this.area,e)}if(d){d.find(".jsvee-value").remove();h.appendTo(d);f(h)}else{JSVEE.handlers.actions.createVariable.call(this,function(j){h.appendTo(j)},e,i?c:null);f(h)}};JSVEE.handlers.animations.assign=function(m,c,d){var n=null;var l=true;var i=null;var e=null;var h=[];if(d===undefined||d.toString()[0]==="@"){n=JSVEE.utils.ui.findFirstValue(this.area);if(d&&d.toString()[0]==="@"){if(n.length==0){n=JSVEE.utils.ui.findVariable(this.area,c).find(".jsvee-value");l=false
}var f=JSVEE.utils.ui.findVariable(this.area,d.substring(1));e=f.find(".jsvee-value").attr("data-id");i=JSVEE.utils.ui.findVariable(this.area,c,e);h.push(f.find(".jsvee-value"));h.push(JSVEE.utils.ui.findValueById(this.area,e));b.each(h,function(){this.addClass("jsvee-highlight")})}else{i=JSVEE.utils.ui.findVariable(this.area,c)}}else{n=JSVEE.utils.ui.findParameterValue(this.area,d);i=JSVEE.utils.ui.findVariable(this.area,c);l=false}var g=function(){b.each(h,function(){this.removeClass("jsvee-highlight")
});m()};if(i){var k=null;if(i.find(".jsvee-value").length>0){k=i.find(".jsvee-value").first()}JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,n,i,l,g,false,k)}else{var j=JSVEE.utils.ui.createEmptyVariable();JSVEE.utils.ui.placeVariable(this.area,c,j,e?d:null);JSVEE.utils.ui.resizeStack(this.area);JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,n,j,l,function(){j.remove();g()})}};JSVEE.registerAction("assign",JSVEE.handlers.actions.assign);JSVEE.handlers.explanations.assign=JSVEE.messages.assign;
JSVEE.registerAction("assignParameter",JSVEE.handlers.actions.assign);JSVEE.handlers.animations.assignParameter=JSVEE.handlers.animations.assign;JSVEE.handlers.explanations.assignParameter=JSVEE.messages.assignParameter;JSVEE.registerAction("assignField",JSVEE.handlers.actions.assign);JSVEE.handlers.animations.assignField=JSVEE.handlers.animations.assign;JSVEE.handlers.explanations.assignField=JSVEE.messages.assignField;JSVEE.handlers.actions.assignParameters=function(c,f){var d=this;var e=[];b.each(f,function(g){JSVEE.handlers.actions.assign.call(d,function(h){e.push(h);
if(e.length===f.length){c(e)}},this,g)})};JSVEE.handlers.animations.assignParameters=function(c,f){var d=this;var e=0;b.each(f,function(g){JSVEE.handlers.animations.assign.call(d,function(){e++;if(e===f.length){c()}},this,g)})};JSVEE.registerAction("assignParameters",JSVEE.handlers.actions.assignParameters);JSVEE.handlers.explanations.assignParameters=JSVEE.messages.assignParameters;JSVEE.handlers.actions.assignFields=function(c,g,e){var d=this;var f=[];b.each(g,function(h){JSVEE.handlers.actions.assign.call(d,function(i){f.push(i);
if(f.length===g.length){c(f)}},this,e)})};JSVEE.handlers.animations.assignFields=function(c,g,e){var d=this;var f=0;b.each(g,function(h){JSVEE.handlers.animations.assign.call(d,function(){f++;if(f===g.length){c()}},this,e)})};JSVEE.registerAction("assignFields",JSVEE.handlers.actions.assignFields);JSVEE.handlers.explanations.assignFields=JSVEE.messages.assignFields;JSVEE.handlers.actions.addValueFromVariable=function(f,e,c){var d=JSVEE.utils.ui.findVariable(this.area,e);if(!d){throw"Variable "+e+" not found."
}var g=d.find(".jsvee-value, .jsvee-function").first().clone();var h=JSVEE.utils.ui.findEvaluationArea(this.area,c);g.appendTo(h);f(g)};JSVEE.handlers.animations.addValueFromVariable=function(f,e,c){var d=JSVEE.utils.ui.findVariable(this.area,e);if(!d){throw"Variable "+e+" not found."}var g=d.find(".jsvee-value, .jsvee-function").first();var h=JSVEE.utils.ui.findEvaluationArea(this.area,c);JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,g,h,false,f)};JSVEE.registerAction("addValueFromVariable",JSVEE.handlers.actions.addValueFromVariable);
JSVEE.handlers.explanations.addValueFromVariable=JSVEE.messages.addValueFromVariable;JSVEE.handlers.actions.addValueFromField=function(k,c,e,h){var l=null;var d=null;if(e!=""){var i=JSVEE.utils.ui.findVariable(this.area,e.substring(1));d=i.find(".jsvee-value").attr("data-id")}else{var g=JSVEE.utils.ui.findElement(this.area,h);d=g.attr("data-id");g.remove()}var f=JSVEE.utils.ui.findVariable(this.area,c,d);l=f.find(".jsvee-value").first().clone();var j=JSVEE.utils.ui.findEvaluationArea(this.area,h);
l.appendTo(j);k(l)};JSVEE.handlers.animations.addValueFromField=function(m,c,e,j){var k=null;var d=null;var g=null;if(e!=""){k=JSVEE.utils.ui.findVariable(this.area,e.substring(1));d=k.find(".jsvee-value").attr("data-id");g=k.find(".jsvee-value")}else{var i=JSVEE.utils.ui.findElement(this.area,j);g=i;d=i.attr("data-id")}var h=JSVEE.utils.ui.findVariable(this.area,c,d);var n=h.find(".jsvee-value").first();var l=JSVEE.utils.ui.findEvaluationArea(this.area,j);g.addClass("jsvee-highlight");h.parents(".jsvee-instance").addClass("jsvee-highlight");
var f=function(){g.removeClass("jsvee-highlight");h.parents(".jsvee-instance").removeClass("jsvee-highlight");m()};JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,n,l,false,f)};JSVEE.registerAction("addValueFromField",JSVEE.handlers.actions.addValueFromField);JSVEE.handlers.explanations.addValueFromField=JSVEE.messages.addValueFromField;JSVEE.handlers.actions.addOperator=function(g,d,c,f){var i=JSVEE.utils.ui.findOperator(this.area,d,c);var h=JSVEE.utils.ui.findEvaluationArea(this.area,c);
var e=i.clone();e.appendTo(h);if(i.attr("data-type")==="p"||i.attr("data-type")==="pr"){JSVEE.utils.ui.createOperatorParameters(e)}if(f){e.attr("data-type")==f}g(e)};JSVEE.handlers.animations.addOperator=function(e,d,c){var g=JSVEE.utils.ui.findOperator(this.area,d,c);var f=JSVEE.utils.ui.findEvaluationArea(this.area,c);JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,g,f,false,e)};JSVEE.registerAction("addOperator",JSVEE.handlers.actions.addOperator);JSVEE.handlers.explanations.addOperator=JSVEE.messages.addOperator;
JSVEE.handlers.actions.evaluateOperator=function(f,d){var g=JSVEE.utils.ui.findElement(this.area,d);var e=JSVEE.utils.ui.findOperands(g);var c=function(h){if(h){g.replaceWith(h.clone())}else{g.remove()}b.each(e,function(){this.remove()});f(h)};if(g.attr("data-class")&&JSVEE.handlers.classes.hasOwnProperty(g.attr("data-class"))){JSVEE.handlers.classes[g.attr("data-class")].call(this,c,this.area,g,e)}else{if(JSVEE.handlers.operators.hasOwnProperty(g.attr("data-name"))){JSVEE.handlers.operators[g.attr("data-name")].call(this,c,this.area,g,e)
}else{if(JSVEE.handlers.global){JSVEE.handlers.global.call(this,c,this.area,g,e)}else{c()}}}};JSVEE.handlers.explanations.evaluateOperator=function(c){var d=JSVEE.utils.ui.findElement(this.area,c);return JSVEE.messages.evaluateOperator(d.attr("data-name"))};JSVEE.handlers.animations.evaluateOperator=JSVEE.utils.ui.flashElement;JSVEE.registerAction("evaluateOperator",JSVEE.handlers.actions.evaluateOperator);JSVEE.handlers.actions.addFunction=function(f,d,c,i,e){var g=JSVEE.utils.ui.findFunction(this.area,d,i,e,c);
var h=JSVEE.utils.ui.findEvaluationArea(this.area,c);var j=g.clone().appendTo(h);j.attr("data-params",i);JSVEE.utils.ui.convertFunctionToCallable(j);f(j)};JSVEE.handlers.animations.addFunction=function(f,d,c,i,e){var g=JSVEE.utils.ui.findFunction(this.area,d,i,e,c);var h=JSVEE.utils.ui.findEvaluationArea(this.area,c);JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,g,h,false,f)};JSVEE.handlers.explanations.addFunction=function(d,c,f,e){if(!e){return JSVEE.messages.addFunction(d)}return JSVEE.messages.addMethod(d)
};JSVEE.registerAction("addFunction",JSVEE.handlers.actions.addFunction);JSVEE.handlers.actions.addFunctionReference=function(f,d,c,i,e){var g=JSVEE.utils.ui.findFunction(this.area,d,i,e);var h=JSVEE.utils.ui.findEvaluationArea(this.area,c);var j=g.clone().appendTo(h);j.text(j.attr("data-name"));f(j)};JSVEE.handlers.animations.addFunctionReference=function(f,d,c,i,e){var g=JSVEE.utils.ui.findFunction(this.area,d,i,e);var h=JSVEE.utils.ui.findEvaluationArea(this.area,c);JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,g,h,false,f)
};JSVEE.handlers.explanations.addFunctionReference=JSVEE.messages.addFunction;JSVEE.registerAction("addFunctionReference",JSVEE.handlers.actions.addFunctionReference);JSVEE.handlers.actions.addFunctionFromVariable=function(k,c,h,f){var g=JSVEE.utils.ui.findVariable(this.area,c);var e=g.find(".jsvee-function, .jsvee-value").first();if(e.hasClass("jsvee-ref")){var d=e.attr("data-id");e=JSVEE.utils.ui.findValueById(this.area,d).clone();e.children().remove();JSVEE.utils.ui.createReference(this.area,d).appendTo(e);
e.append(b("<span>&nbsp;</span>"))}e.removeClass("jsvee-value");e.removeClass("jsvee-instance");e.removeClass("jsvee-ref");e.addClass("jsvee-function");var j=JSVEE.utils.ui.findEvaluationArea(this.area,h);var i=e.clone().appendTo(j);JSVEE.utils.ui.convertFunctionToCallable(i);k(i)};JSVEE.handlers.animations.addFunctionFromVariable=function(f,e,c,i){var d=JSVEE.utils.ui.findVariable(this.area,e);var g=d.find(".jsvee-function, .jsvee-value").first();var h=JSVEE.utils.ui.findEvaluationArea(this.area,c);
JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,g,h,false,f)};JSVEE.handlers.explanations.addFunctionFromVariable=JSVEE.messages.addValueFromVariable;JSVEE.registerAction("addFunctionFromVariable",JSVEE.handlers.actions.addFunctionFromVariable);JSVEE.handlers.actions.evaluateFunction=function(e,d){var f=JSVEE.utils.ui.findElement(this.area,d);if(!JSVEE.utils.ui.isFunctionBuiltin(f)){f.addClass("jsvee-active");var g=null;JSVEE.handlers.actions.createFrame.call(this,function(h){g=h},f.attr("data-pc"));
this.setPC(this.area.find(".jsvee-stack-frame").first().attr("data-pc"));e(g)}else{var c=function(h){if(h){f.replaceWith(h.clone())}else{f.remove()}e(h)};if(f.attr("data-class")&&JSVEE.handlers.classes.hasOwnProperty(f.attr("data-class"))){JSVEE.handlers.classes[f.attr("data-class")].call(this,c,this.area,f)}else{if(JSVEE.handlers.functions.hasOwnProperty(f.attr("data-name"))){JSVEE.handlers.functions[f.attr("data-name")].call(this,c,this.area,f)}else{if(JSVEE.handlers.global){JSVEE.handlers.global.call(this,c,this.area,f)
}else{c()}}}}};JSVEE.handlers.animations.evaluateFunction=function(d,c){var f=this;var e=JSVEE.utils.ui.findElement(this.area,c);JSVEE.utils.ui.flashElement.call(this,function(){if(!JSVEE.utils.ui.isFunctionBuiltin(e)){var g=f.getPC();a.call(f,JSVEE.handlers.actions.evaluateFunction).call(f,d,c);f.setPC(g)}else{d()}},c)};JSVEE.handlers.explanations.evaluateFunction=function(c){var e=JSVEE.utils.ui.findElement(this.area,c);var d=e.attr("data-name");if(!JSVEE.utils.ui.isFunctionBuiltin(e)&&!e.attr("data-class")){return JSVEE.messages.evaluateFunction(d)
}if(JSVEE.utils.ui.isFunctionBuiltin(e)&&!e.attr("data-class")){return JSVEE.messages.evaluateBuiltInFunction(d)}if(!JSVEE.utils.ui.isFunctionBuiltin(e)&&e.attr("data-class")){return JSVEE.messages.evaluateMethod(d)}return JSVEE.messages.evaluateBuiltInMethod(d)};JSVEE.registerAction("evaluateFunction",JSVEE.handlers.actions.evaluateFunction);JSVEE.handlers.actions.createParameterVariables=function(d,f){var e=this;var g=[];var c=function(h){g.push(h);if(g.length===f.length){d(g)}};b.each(f,function(){JSVEE.handlers.actions.createVariable.call(e,c,this)
})};JSVEE.registerAction("createParameterVariables",JSVEE.handlers.actions.createParameterVariables);JSVEE.handlers.animations.createParameterVariables=a(JSVEE.handlers.actions.createParameterVariables);JSVEE.handlers.explanations.createParameterVariables=JSVEE.messages.createParameterVariables;JSVEE.handlers.actions.createFields=function(d,g,f){var e=this;var h=[];var c=function(i){h.push(i);if(h.length===g.length){d(h)}};b.each(g,function(){JSVEE.handlers.actions.createVariable.call(e,c,this,f)
})};JSVEE.registerAction("createFields",JSVEE.handlers.actions.createFields);JSVEE.handlers.animations.createFields=a(JSVEE.handlers.actions.createFields);JSVEE.handlers.explanations.createFields=JSVEE.messages.createFields;JSVEE.handlers.actions.returnValue=function(c){var f=JSVEE.utils.ui.findFirstValue(this.area);var e=JSVEE.utils.ui.findActiveCall(this.area);var g=this.area.find(".jsvee-stack-frame").eq(1);e.replaceWith(f);if(g.attr("data-line")){JSVEE.handlers.actions.setLine.call(this,function(){return
},g.attr("data-line"))}this.area.find(".jsvee-stack-frame").first().remove();var d=this.area.find(".jsvee-stack-frame").first().attr("data-pc");this.setPC(d);c(f)};JSVEE.handlers.animations.returnValue=function(d){var f=this;var g=JSVEE.utils.ui.findFirstValue(this.area);var e=JSVEE.utils.ui.findActiveCall(this.area);var h=this.area.find(".jsvee-stack-frame").first();var c=e.find(".jsvee-function-name, .jsvee-ref").first();JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,g,c,true,function(){e.before(g.clone());
g.hide();e.hide();JSVEE.utils.ui.resizeStack(f.area);h.delay(f.animationLength).fadeOut(f.animationLength,function(){e.before().remove();d()})},true)};JSVEE.registerAction("returnValue",JSVEE.handlers.actions.returnValue);JSVEE.handlers.explanations.returnValue=JSVEE.messages.returnValue;JSVEE.handlers.actions.returnVoid=function(c){var e=JSVEE.utils.ui.findActiveCall(this.area);var f=this.area.find(".jsvee-stack-frame").eq(1);e.remove();if(f.attr("data-line")){JSVEE.handlers.actions.setLine.call(this,function(){return
},f.attr("data-line"))}this.area.find(".jsvee-stack-frame").first().remove();var d=this.area.find(".jsvee-stack-frame").first().attr("data-pc");this.setPC(d);c()};JSVEE.handlers.animations.returnVoid=function(c){var d=this;var e=this.area.find(".jsvee-stack-frame").first();e.delay(d.animationLength).fadeOut(d.animationLength,function(){c()})};JSVEE.registerAction("returnVoid",JSVEE.handlers.actions.returnVoid);JSVEE.handlers.explanations.returnVoid=JSVEE.messages.returnVoid;JSVEE.handlers.actions.conditionalJump=function(d,g,f){var e=JSVEE.utils.ui.findFirstValue(this.area);
var c=JSVEE.handlers.truthness(e);if(c){this.setPC(g)}else{this.setPC(f)}d()};JSVEE.registerAction("conditionalJump",JSVEE.handlers.actions.conditionalJump);JSVEE.handlers.actions.createInstance=function(h,f,l,j,e){var k=JSVEE.utils.ui.createInstance(this.area,f);this.area.find(".jsvee-heap").append(k);if(l){var d=0;for(d=0;d<l.length;d++){var m=JSVEE.utils.ui.createVariable(l[d]);m.appendTo(k);if(j&&d<j.length){var g=e&&d<e.length;var c=JSVEE.utils.ui.findOrCreateValue(this.area,j[d],g?e[d]:undefined);
c.clone().appendTo(m)}}}else{if(!l&&j){for(d=0;d<j.length;d++){var g=e&&d<e.length;var c=JSVEE.utils.ui.createValue(j[d],k.attr("data-id"),g?e[d]:undefined);c.clone().appendTo(k)}}}h(k)};JSVEE.handlers.animations.createInstance=function(f,e,j,c,d){var g=this;var i=g.area.find(".jsvee-heap").attr("data-id-counter");var h=function(){g.area.find(".jsvee-heap").attr("data-id-counter",i);f()};a(JSVEE.handlers.actions.createInstance).call(this,h,e,j,c,d)};JSVEE.handlers.explanations.createInstance=JSVEE.messages.createInstance;
JSVEE.registerAction("createInstance",JSVEE.handlers.actions.createInstance);JSVEE.handlers.actions.disableAnimations=function(c){var d=this;JSVEE.utils.ui.setStatusText(d.area," ");d.state.animationsDisabled=true;c()};JSVEE.registerAction("disableAnimations",JSVEE.handlers.actions.disableAnimations);JSVEE.handlers.actions.enableAnimations=function(c){var d=this;if(!d.state.reEnableAnimations){d.state.animationsDisabled=false}if(d.area.find(".jsvee-status-area").text().trim().length>0){}c()};JSVEE.registerAction("enableAnimations",JSVEE.handlers.actions.enableAnimations);
JSVEE.handlers.actions.disableStepping=function(c){var d=this;d.state.continueRunning=true;c()};JSVEE.registerAction("disableStepping",JSVEE.handlers.actions.disableStepping);JSVEE.handlers.actions.enableStepping=function(c){var d=this;if(!d.state.reEnableAnimations){d.state.continueRunning=false}c()};JSVEE.registerAction("enableStepping",JSVEE.handlers.actions.enableStepping);JSVEE.handlers.actions.runForward=function(c,e,f){var d=this;d.state.stepsToRun=+e+1;JSVEE.utils.ui.setStatusText(this.area,f);
c()};JSVEE.registerAction("runForward",JSVEE.handlers.actions.runForward);JSVEE.handlers.actions.flashElement=function(d,c){JSVEE.utils.ui.flashElement.call(this,d,c)};JSVEE.registerAction("flashElement",JSVEE.handlers.actions.flashElement);JSVEE.handlers.actions.showText=function(c,d){JSVEE.utils.ui.setStatusText(this.area,d);c()};JSVEE.registerAction("showText",JSVEE.handlers.actions.showText);JSVEE.handlers.actions.alert=function(c,d){alert(d);c()};JSVEE.handlers.explanations.alert=JSVEE.messages.alert;
JSVEE.registerAction("alert",JSVEE.handlers.actions.alert);JSVEE.handlers.actions.alertOnce=function(c,d){this.steps[this.getPC()-1][0]="_nop";alert(d);c()};JSVEE.handlers.explanations.alertOnce=JSVEE.messages.alert;JSVEE.registerAction("alertOnce",JSVEE.handlers.actions.alertOnce);JSVEE.handlers.actions.addReference=function(d,g,c){var e=JSVEE.utils.ui.findReference(this.area,g);var f=JSVEE.utils.ui.findEvaluationArea(this.area,c);e.appendTo(f);d(e)};JSVEE.handlers.animations.addReference=function(e,h,d){var f=JSVEE.utils.ui.findReference(this.area,h);
var c=JSVEE.utils.ui.findValueById(this.area,f.attr("data-id"));f.appendTo(this.area.find(".jsvee-animation-area"));f.css("position","absolute");f.offset(c.offset());var g=JSVEE.utils.ui.findEvaluationArea(this.area,d);JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,f,g,true,function(){f.remove();e()})};JSVEE.registerAction("addReference",JSVEE.handlers.actions.addReference);JSVEE.handlers.explanations.addReference=function(d){var c=JSVEE.utils.ui.findReference(this.area,d).attr("data-id");
return JSVEE.messages.addReference(c)};JSVEE.handlers.actions.createArray=function(o,j,m,p,f,d){var q=JSVEE.utils.ui.createInstance(this.area,m);this.area.find(".jsvee-heap").append(q);var l=JSVEE.utils.ui.findElement(this.area,j);var r=+l.find(".jsvee-value").first().text();if(d){var k=JSVEE.utils.ui.createVariable(d);var n=l.find(".jsvee-value").first().clone();n.appendTo(k);k.appendTo(q)}var h=0,g=null;for(h=0;h<r;h++){g=JSVEE.utils.ui.findOrCreateValue(this.area,p,f).clone();g.appendTo(q)}var c=q.attr("data-id");
var e=JSVEE.utils.ui.createReference(this.area,c);l.replaceWith(e);o(q)};JSVEE.handlers.animations.createArray=JSVEE.utils.ui.flashElement;JSVEE.handlers.explanations.createArray=function(c,f,d,e){return JSVEE.messages.createArray(e)};JSVEE.registerAction("createArray",JSVEE.handlers.actions.createArray);JSVEE.handlers.actions.getValueAtIndex=function(e,c){var h=JSVEE.utils.ui.findElement(this.area,c);var g=h.find(".jsvee-value").first().attr("data-id");var d=h.find(".jsvee-value").eq(1).text();var f=JSVEE.utils.ui.findValueInCollection(this.area,g,d);
if(f.length==0){throw"Incorrect index."}h.replaceWith(f.clone());e(f)};JSVEE.handlers.animations.getValueAtIndex=function(e,d){var f=this;var c=function(){var j=JSVEE.utils.ui.findElement(f.area,d);var i=j.find(".jsvee-value").first().attr("data-id");var g=j.find(".jsvee-value").eq(1).text();var h=JSVEE.utils.ui.findValueInCollection(f.area,i,g);if(h.length==0){throw"Incorrect index."}JSVEE.utils.ui.animateMoveToTarget.call(f,f.area,h,j,false,e,false,j.find(".jsvee-value").first())};JSVEE.utils.ui.flashElement.call(this,c,d)
};JSVEE.handlers.explanations.getValueAtIndex=JSVEE.messages.getValueAtIndex;JSVEE.registerAction("getValueAtIndex",JSVEE.handlers.actions.getValueAtIndex);JSVEE.handlers.actions.getValueByKey=function(e,c){var h=JSVEE.utils.ui.findElement(this.area,c);var g=h.find(".jsvee-value").first().attr("data-id");var d=h.find(".jsvee-value").eq(1).text();var f=JSVEE.utils.ui.findValueInSet(this.area,g,d);h.replaceWith(f.clone());e(f)};JSVEE.handlers.animations.getValueByKey=function(e,d){var f=this;var c=function(){var j=JSVEE.utils.ui.findElement(f.area,d);
var i=j.find(".jsvee-value").first().attr("data-id");var g=j.find(".jsvee-value").eq(1).text();var h=JSVEE.utils.ui.findValueInSet(f.area,i,g);JSVEE.utils.ui.animateMoveToTarget.call(f,f.area,h,j,false,e,false,j.find(".jsvee-value").first())};JSVEE.utils.ui.flashElement.call(this,c,d)};JSVEE.handlers.explanations.getValueByKey=JSVEE.messages.getValueByKey;JSVEE.registerAction("getValueByKey",JSVEE.handlers.actions.getValueByKey);JSVEE.handlers.actions.setValueAtIndex=function(f,c){var i=JSVEE.utils.ui.findElement(this.area,c);
var h=i.find(".jsvee-value").first().attr("data-id");var e=i.find(".jsvee-value").eq(1).text();var d=JSVEE.utils.ui.findValueInCollection(this.area,h,e);var g=i.find(".jsvee-value").eq(2);d.replaceWith(g.clone());i.remove();f(g)};JSVEE.handlers.animations.setValueAtIndex=function(e,d){var f=this;var c=function(){var k=JSVEE.utils.ui.findElement(f.area,d);var j=k.find(".jsvee-value").first().attr("data-id");var h=k.find(".jsvee-value").eq(1).text();var g=JSVEE.utils.ui.findValueInCollection(f.area,j,h);
var i=k.find(".jsvee-value").eq(2);JSVEE.utils.ui.animateMoveToTarget.call(f,f.area,i,g,false,e,false,g)};JSVEE.utils.ui.flashElement.call(this,c,d)};JSVEE.handlers.explanations.setValueAtIndex=JSVEE.messages.setValueAtIndex;JSVEE.registerAction("setValueAtIndex",JSVEE.handlers.actions.setValueAtIndex);JSVEE.handlers.actions.setValueByKey=function(f,c){var i=JSVEE.utils.ui.findElement(this.area,c);var h=i.find(".jsvee-value").first().attr("data-id");var e=i.find(".jsvee-value").eq(1);var d=JSVEE.utils.ui.findValueInSet(this.area,h,e.text());
var g=i.find(".jsvee-value").eq(2);if(d){d.replaceWith(g.clone());i.remove()}else{JSVEE.utils.ui.createKeyValuePair(this.area,h,e,g);i.remove()}f()};JSVEE.handlers.animations.setValueByKey=function(e,d){var f=this;var c=function(){var k=JSVEE.utils.ui.findElement(f.area,d);var j=k.find(".jsvee-value").first().attr("data-id");var h=k.find(".jsvee-value").eq(1).text();var g=JSVEE.utils.ui.findValueInSet(f.area,j,h);if(g){var i=k.find(".jsvee-value").eq(2);JSVEE.utils.ui.animateMoveToTarget.call(f,f.area,i,g,false,e,false,g)
}else{e()}};JSVEE.utils.ui.flashElement.call(this,c,d)};JSVEE.handlers.explanations.setValueByKey=JSVEE.messages.setValueByKey;JSVEE.registerAction("setValueByKey",JSVEE.handlers.actions.setValueByKey);JSVEE.handlers.actions.nop=function(c){c()};JSVEE.registerAction("nop",JSVEE.handlers.actions.nop);JSVEE.registerAction("end",JSVEE.handlers.actions.nop);JSVEE.handlers.actions.convertFunctionToCallable=function(e,c){var d=JSVEE.utils.ui.findElement(this.area,c);JSVEE.utils.ui.convertFunctionToCallable(d);
JSVEE.utils.ui.resizeStack(this.area);e(d)};JSVEE.registerAction("convertFunctionToCallable",JSVEE.handlers.actions.convertFunctionToCallable);JSVEE.handlers.actions.showInfo=function(c,d,e){JSVEE.utils.ui.showInfoText(this.area,d,e);c(d)};JSVEE.registerAction("showInfo",JSVEE.handlers.actions.showInfo);JSVEE.handlers.actions.hideInfo=function(c){JSVEE.utils.ui.hideInfo(this.area);c()};JSVEE.registerAction("hideInfo",JSVEE.handlers.actions.hideInfo);JSVEE.handlers.actions.createIterator=function(i,c,g,j,k,h){var d=this.area.find(".jsvee-stack-frame").first();
d.find('.jsvee-iterator[data-name="'+c+'"]').remove();var l=g;if(g.toString()[0]==="@"){var e=JSVEE.utils.ui.findVariable(this.area,g.substring(1));l=e.find(".jsvee-value").attr("data-id")}var f=JSVEE.utils.ui.createIterator(c,l,j,k,h);f.appendTo(d);i(f)};JSVEE.registerAction("createIterator",JSVEE.handlers.actions.createIterator);JSVEE.handlers.actions.iterate=function(k,d,g,e){var f=this.area.find(".jsvee-stack-frame").first();var h=f.find('.jsvee-iterator[data-name="'+d+'"]').first();var n=true;
var j=+h.attr("data-current");var m=h.attr("data-collection");if(m){var i=JSVEE.utils.ui.findValueById(this.area,m);var c=-1;if(i.hasClass("jsvee-instance")){c=i.children(".jsvee-key-value-pair, .jsvee-value").length}else{c=i.attr("data-value").length}n=++j<c}else{var l=+h.attr("data-to");n=j++<l}if(n){h.attr("data-current",j);this.setPC(g)}else{this.setPC(e)}k()};JSVEE.registerAction("iterate",JSVEE.handlers.actions.iterate);JSVEE.handlers.actions.takeNext=function(f,d,c){var j=this.area.find(".jsvee-stack-frame").first();
var e=j.find('.jsvee-iterator[data-name="'+d+'"]').first();var h=JSVEE.utils.ui.findValueToBeIterated(this.area,e);var g=h.clone();if(h.parent().is(".jsvee-instance")){if(!h.is(":visible")){g.show();g.attr("style",null)}}var i=JSVEE.utils.ui.findEvaluationArea(this.area,c);g.appendTo(i);f(g)};JSVEE.handlers.animations.takeNext=function(f,d,c){var j=this.area.find(".jsvee-stack-frame").first();var e=j.find('.jsvee-iterator[data-name="'+d+'"]').first();var h=JSVEE.utils.ui.findValueToBeIterated(this.area,e);
var i=JSVEE.utils.ui.findEvaluationArea(this.area,c);var g=false;if(!h.is(":visible")&&h.parent().is(".jsvee-instance")){g=true;h.show()}JSVEE.utils.ui.animateMoveToTarget.call(this,this.area,h,i,false,function(){if(g){h.hide()}f()})};JSVEE.registerAction("takeNext",JSVEE.handlers.actions.takeNext);JSVEE.handlers.explanations.takeNext=JSVEE.messages.takeNext;JSVEE.handlers.actions.addCollectionInitializer=function(d,e,c,h){var g=JSVEE.utils.ui.createCollectionInitializer(this.area,e,h);var f=JSVEE.utils.ui.findEvaluationArea(this.area,c);
g.appendTo(f);d(g)};JSVEE.handlers.animations.addCollectionInitializer=JSVEE.handlers.animations.addReference;JSVEE.handlers.explanations.addCollectionInitializer=JSVEE.messages.addCollectionInitializer;JSVEE.registerAction("addCollectionInitializer",JSVEE.handlers.actions.addCollectionInitializer);JSVEE.handlers.actions.initializeCollection=function(g,c){var f=JSVEE.utils.ui.findElement(this.area,c);var j=f.find(".jsvee-value").first().attr("data-id");var k=JSVEE.utils.ui.findValueById(this.area,j);
k.children(".jsvee-value").remove();var d=f.find(".jsvee-value");var h=JSVEE.utils.ui.createReference(this.area,j);var e=0;for(e=1;e<d.length;e++){d.eq(e).clone().appendTo(k)}f.replaceWith(h);g(k)};JSVEE.handlers.animations.initializeCollection=JSVEE.utils.ui.flashElement;JSVEE.handlers.explanations.initializeCollection=JSVEE.messages.initializeCollection;JSVEE.registerAction("initializeCollection",JSVEE.handlers.actions.initializeCollection);JSVEE.handlers.actions.beginBlock=function(c){var f=this.area.find(".jsvee-stack-frame").first();
var d=f.find(".jsvee-variable-empty");var e=b("<div></div>").addClass("jsvee-block");d.before(e);c(e)};JSVEE.registerAction("beginBlock",JSVEE.handlers.actions.beginBlock);JSVEE.handlers.actions.endBlock=function(c){var e=this.area.find(".jsvee-stack-frame").first();var d=e.find(".jsvee-variable-empty");d.prevUntil(".jsvee-block").remove();e.find(".jsvee-block").last().remove();c()};JSVEE.registerAction("endBlock",JSVEE.handlers.actions.endBlock);JSVEE.handlers.actions.removeVariable=function(e,d){var c=JSVEE.utils.ui.findVariable(this.area,d);
c.remove();e()};JSVEE.registerAction("removeVariable",JSVEE.handlers.actions.removeVariable);JSVEE.handlers.actions.clearEvaluationArea=function(c){JSVEE.utils.ui.findEvaluationArea(this.area,"0").children().remove();c()};JSVEE.registerAction("clearEvaluationArea",JSVEE.handlers.actions.clearEvaluationArea);JSVEE.handlers.actions.deleteState=function(c){this.deleteState();c()};JSVEE.registerAction("deleteState",JSVEE.handlers.actions.deleteState);JSVEE.handlers.actions.ifFunctionDefined=function(e,c,i,g,h,d){var f=JSVEE.utils.ui.findFunction(this.area,c,i,d);
if(f){this.setPC(g)}else{this.setPC(h)}e()};JSVEE.registerAction("ifFunctionDefined",JSVEE.handlers.actions.ifFunctionDefined)}(jQuery));(function(a){if(window.JSVEE===undefined){return}JSVEE.ui=function(f,d,c){this.animation=a.extend(true,{},JSVEE.animations.getAnimation(f));if(this.animation===null){return}var b={code:"top",console:true,controls:true,stackHeight:100,rightPanelsWidth:150,heapHeight:80,width:850,codeWidth:"auto",classesLeft:false,consoleBelowHeap:false,consoleLeft:false};this.settings=a.extend(true,b,c,this.animation.settings);
this.area=a(d);this.engine=new JSVEE(this.area,this.settings);this.engine.ui=this;this.engine.animationId=f;this.createLayout();this.initializeEngine();if(this.animation.description){var e=a("<div></div>").html(this.animation.description);this.area.before(e);e.after(a("<hr>"))}this.updateButtons();this.updateInfo()};JSVEE.afterEachStep(false,function(b){if(!this.actionsRunning||!this.state.animationsDisabled){JSVEE.utils.ui.resizeStack(this.area);this.ui.updateInfo()}});JSVEE.afterEachStep(true,function(b){if(!this.actionsRunning){this.ui.updateButtons()
}if(this.hasEnded()){JSVEE.utils.ui.appendToStatus(this.area," "+JSVEE.messages.animationEnded())}});JSVEE.ui.prototype.createLayout=function(){this.area.css("position","relative");var g=a("<div></div>").addClass("jsvee-animation-area");g.css("width",this.settings.width+"px");g.appendTo(this.area);var h=g.outerWidth(true)-g.width();g.css("width",(+this.settings.width-h)+"px");this.area.css("width",g.outerWidth(true)+"px");if(this.settings.small===true){this.area.addClass("jsvee-small")}this.engine.addUndoableElement(".jsvee-animation-area");
this.engine.addUndoableElement(".jsvee-info-area");this.createStatusArea();this.createControls();this.createCodeArea();var f=this.createMemoryArea();var d=a("<div></div>").addClass("jsvee-info-area");d.hide();d.appendTo(this.area);if(this.settings.console){var b=a("<div></div>").addClass("jsvee-console");b.attr("data-title",JSVEE.messages.consoleTitle());b.appendTo(f);if(this.settings.consoleBelowHeap===true){var c=this.area.find(".jsvee-heap");c.css("position","relative");b.css("position","absolute");
b.css("bottom",0);b.css("width",(c.width()-(b.outerWidth(true)-b.width()))+"px");b.appendTo(c)}if(this.settings.consoleLeft===true){var c=this.area.find(".jsvee-heap");b.appendTo(c.parent())}if(this.settings.consoleFull){f.after(b)}}var e=this;this.area.on("mouseenter",".jsvee-ref",function(){var i=e.area.find('.jsvee-instance[data-id="'+a(this).data("id")+'"]');i.addClass("jsvee-highlight");var j=JSVEE.utils.ui.drawArrow(e.area,a(this),i);j.appendTo(e.area)});this.area.on("mouseleave",".jsvee-ref",function(){e.area.find('.jsvee-instance[data-id="'+a(this).data("id")+'"]').removeClass("jsvee-highlight");
e.area.find('.jsvee-ref[data-id="'+a(this).data("id")+'"]').removeClass("jsvee-highlight");e.area.find(".jsvee-ref-arrow").remove()})};JSVEE.ui.prototype.initializeEngine=function(){var c=this;a.each(this.animation.init,function(){var d=this[0];this.shift();c.engine[d].apply(c.engine,this)});a.each(this.animation.steps,function(){c.engine.addStep(this)});if(this.area.attr("data-jsvee-startline")){var b=0;c.engine.initSkippedSteps=0;while(b<200&&!this.engine.hasEnded()&&+this.area.find(".jsvee-code-area").attr("data-line")!=+this.area.attr("data-jsvee-startline")){c.engine.makeStep();
c.engine.initSkippedSteps++;b++}}JSVEE.utils.ui.resizeStack(this.area);if(JSVEE.ui.finishLayout){JSVEE.ui.finishLayout.call(this)}this.engine.initReady()};JSVEE.ui.prototype.createControls=function(){if(!this.settings.controls){return}var f=this;var c=a("<div></div>").addClass("jsvee-controls-area");c.appendTo(this.area);var e=a("<button></button>").addClass("jsvee-button jsvee-btn jsvee-begin").attr("title",JSVEE.messages.beginButton());a("<div></div>").appendTo(e);e.appendTo(c);e.click(function(h){h.preventDefault();
f.engine.toBegin();f.updateButtons();JSVEE.utils.ui.setStatusText(f.area,JSVEE.messages.begin())});var d=a("<button></button>").addClass("jsvee-button jsvee-btn jsvee-undo").attr("title",JSVEE.messages.prevButton());a("<div></div>").appendTo(d);d.appendTo(c);d.click(function(h){h.preventDefault();f.engine.undo();f.updateButtons();JSVEE.utils.ui.setStatusText(f.area,JSVEE.messages.undo())});var g=a("<button></button>").addClass("jsvee-button jsvee-btn jsvee-step").attr("title",JSVEE.messages.stepButton());
a("<div></div>").appendTo(g);g.appendTo(c);g.click(function(h){h.preventDefault();f.area.find(".jsvee-controls-area button").attr("disabled","disabled");f.engine.makeStep()});var b=a("<button></button>").addClass("jsvee-button jsvee-btn jsvee-redo").attr("title",JSVEE.messages.redoButton());a("<div></div>").appendTo(b);b.appendTo(c);b.click(function(h){h.preventDefault();f.engine.redo();f.updateButtons();JSVEE.utils.ui.setStatusText(f.area,JSVEE.messages.redo())});return c};JSVEE.ui.prototype.createStatusArea=function(){var b=a("<div>&nbsp;</div>").addClass("jsvee-status-area");
b.appendTo(this.area)};JSVEE.ui.prototype.createMemoryArea=function(){var f=this.area.find(".jsvee-animation-area");var h=this.area.find(".jsvee-code-area");var m=null;if(this.settings.twoColumns){m=a("<div></div>").css("float","right");h.after(m);h.css("float","left")}var l=a("<div></div>").addClass("jsvee-memory-area");l.appendTo(f);if(this.settings.code==="left"){l.css("display","inline-block")}var c=a("<div></div>").addClass("jsvee-heap");c.attr("data-id-counter",1);var j=0;if(this.settings.twoColumns){j=f.width()-h.outerWidth(true)-20
}else{if(this.settings.code==="left"){c.appendTo(l);j=f.width()-h.outerWidth(true)-(c.outerWidth(true)-c.width())-20}else{if(this.settings.code==="top"||this.settings.code==="none"){c.appendTo(l);j=f.width()-(c.outerWidth(true)-c.width())-20}else{if(this.settings.code==="top-left"){h.css("float","left");c.css("float","right");l.css("clear","both");h.after(c);j=f.width()-h.outerWidth(true)-(c.outerWidth(true)-c.width())-20}}}}c.css("width",j+"px");c.css("min-height",this.settings.heapHeight+"px");
var b=a("<div></div>").addClass("jsvee-literals");b.attr("title",JSVEE.messages.literalsTitle());b.text(JSVEE.messages.literals());var e=a("<div></div>").addClass("jsvee-stack-and-right").appendTo(l);var g=a("<div></div>").addClass("jsvee-stack").appendTo(e);g.attr("title",JSVEE.messages.stackTitle());g.css("min-height",this.settings.stackHeight+"px");a("<div></div>").addClass("jsvee-area-label").text(JSVEE.messages.stack()).appendTo(g);a("<div></div>").addClass("jsvee-stack-filler").appendTo(g);
var i=a("<div></div>").addClass("jsvee-right-panels").appendTo(e);i.css("width",this.settings.rightPanelsWidth+"px");if(this.settings.heapHeight==0){b.appendTo(i);c.css("padding","0")}else{b.appendTo(c)}if(this.settings.twoColumns){c.appendTo(m)}a("<div></div>").addClass("jsvee-classes").appendTo(i);a("<div></div>").addClass("jsvee-functions").appendTo(i);a("<div></div>").addClass("jsvee-operators").appendTo(i);var d=c.outerWidth(true)-i.outerWidth(true)-(g.outerWidth(true)-g.width());if(this.settings.twoColumns){d=h.width()-(g.outerWidth(true)-g.width()-5)
}else{if(this.settings.code==="top-left"){d=f.width()-i.outerWidth(true)-(g.outerWidth(true)-g.width())}else{if(this.settings.code==="aboveHeapAndPanels"){var k=a("<div></div>");k.css("display","inline-block");k.css("float","left");k.css("vertical-align","top");k.css("margin-right","10px");l.css("display","inline-block");l.css("float","left");i.css("float","left");b.css("float","right");c.css("float","left");h.appendTo(k);i.appendTo(k);c.appendTo(k);k.prependTo(f);a('<div style="height: 1px; clear: both;">&nbsp;</div>').appendTo(f);
d=f.width()-k.outerWidth(true)-(g.outerWidth(true)-g.width());j=k.width()-i.outerWidth(true)-(c.outerWidth(true)-c.width())-20;c.css("width",j+"px")}}}if(this.settings.classesLeft===true){g.before(i);i.css("margin-right",i.css("margin-left"));i.css("margin-left",0)}if(this.settings.literals==="left"){b.css("float","left");b.css("margin-bottom","10px");b.after(a("<div></div>").css("clear","both"))}if(this.settings.literals==="right"){b.css("float","right")}g.css("width",d+"px");if(this.settings.twoColumns){i.appendTo(m)
}return l};JSVEE.ui.prototype.createCodeArea=function(){var d=a("<div></div>").addClass("jsvee-code-area");d.appendTo(this.area.find(".jsvee-animation-area"));var e=a("<table></table>").addClass("jsvee-code-table");e.appendTo(d);var c=this.animation.lines;var b=1;if(c){a.each(c,function(f,k){var j=a("<tr></tr>");var h=a("<td></td>").text(b++).addClass("jsvee-gutter");var g=a("<td></td>").attr("data-text",k).addClass("jsvee-code-line");a("<span></span>").text(k.length>0?k:" ").appendTo(g);h.appendTo(j);
g.appendTo(j);j.appendTo(e)})}if(this.settings.code==="left"){d.addClass("jsvee-code-left");e.css("margin-bottom","0");d.css("vertical-align","top")}if(this.settings.codeWidth!=="auto"){d.css("width",this.settings.codeWidth+"px");d.css("overflow","auto")}if(this.settings.code==="none"){d.css("display","none")}return d};JSVEE.ui.prototype.updateButtons=function(){var d=this.area.find(".jsvee-button.jsvee-begin");var b=this.area.find(".jsvee-button.jsvee-undo");var e=this.area.find(".jsvee-button.jsvee-step");
var c=this.area.find(".jsvee-button.jsvee-redo");if(this.engine.canUndo()){d.removeAttr("disabled");b.removeAttr("disabled")}else{d.attr("disabled","disabled");b.attr("disabled","disabled")}if(this.engine.canRedo()){c.removeAttr("disabled")}else{c.attr("disabled","disabled")}if(!this.engine.hasEnded()&&!this.engine.actionsRunning){e.removeAttr("disabled")}else{e.attr("disabled","disabled")}};JSVEE.ui.prototype.updateInfo=function(){var c="line"+this.area.find(".jsvee-code-area").attr("data-line");
var b=this.area.find(".jsvee-info-area");if(b.attr("data-info")&&b.attr("data-info")!==c){JSVEE.utils.ui.hideInfo(this.area);b.removeAttr("data-info")}if(this.animation.explanations&&this.animation.explanations.hasOwnProperty(c)){JSVEE.utils.ui.showInfoText(this.area,this.animation.explanations[c]);b.attr("data-info",c)}}}(jQuery));(function(a){a(function(){if(window.JSVEE===undefined){return}var c=false;var b=window.kelmu;if(b){JSVEE.afterInitialization(function(){var d=this;b.registerCallback(d.animationId,function(f,g){if(f==="skip"){JSVEE.utils.ui.setStatusText(d.area,"Moving forward");
d.state.stepsToRun=+g;d.state.animationsDisabled=true;d.state.reEnableAnimations=true}else{if(f==="runToLine"){JSVEE.utils.ui.setStatusText(d.area,"Moving forward");d.state.runToLine=+g;d.state.reEnableAnimations=true;c=true;d.makeStep()}else{if(f==="skipToLine"){JSVEE.utils.ui.setStatusText(d.area,"Moving forward");d.state.runToLine=+g;d.state.reEnableAnimations=true;d.state.animationsDisabled=true;c=true;d.makeStep()}else{if(f==="hideControls"){d.area.find(".jsvee-controls-area").hide()}else{if(f==="showSequence"){d.disableStateSave=true
}else{if(f==="showControls"){d.area.find(".jsvee-controls-area").show()}else{if(f==="getCapabilities"){b.sendMessage(d.animationId,"animationCapabilities",null,["animationReady"])}else{if(f==="getAnimationLength"){b.sendMessage(d.animationId,"animationLength",d.animationLength)}else{if(f==="getButtonDefinitions"){b.sendMessage(d.animationId,"buttonDefinitions",null,{step:".jsvee-step",redo:".jsvee-redo",undo:".jsvee-undo",begin:".jsvee-begin"})}else{if(f==="postponeEnd"){var e=d.area.find(".jsvee-status-area");
e.text(e.text().substring(0,e.text().indexOf(JSVEE.messages.animationEnded())))}else{if(f==="lastSubstepShown"){var e=d.area.find(".jsvee-status-area");e.text(e.text()+JSVEE.messages.animationEnded())}else{if(f==="getCurrentStep"){b.sendMessage(d.animationId,"currentStep",(d.initSkippedSteps||0)+d.state.stepNumberAll)}else{if(f==="getCurrentLine"){b.sendMessage(d.animationId,"currentLine",d.area.find(".jsvee-code-area").attr("data-line"))}}}}}}}}}}}}}})});JSVEE.afterEachStep(true,function(d){if(!this.actionsRunning&&c){b.sendMessage(this.animationId,"currentStep",(this.initSkippedSteps||0)+this.state.stepNumberAll)
}if(!this.actionsRunning||!this.state.animationsDisabled){b.sendMessage(this.animationId,"animationReady")}if(this.hasEnded()){b.sendMessage(this.animationId,"animationEnded")}})}})})(jQuery);